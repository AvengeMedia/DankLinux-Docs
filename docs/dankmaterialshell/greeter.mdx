---
title: Greeter
sidebar_position: 8
---

# Greeter

The DankMaterialShell greeter provides a greetd-compatible login experience that mirrors the aesthetics of the main shell and lock screen. It supports multiple compositors, theme synchronization, and flexible installation paths.

## Features

- **Consistent Styling:** Shares wallpapers, themes, and settings with your main session for seamless transitions.
- **Multi-Compositor Support:** Launches with niri, Hyprland, or sway via a unified wrapper.
- **Multi-User Login:** Presents system users and remembers the last selected session.
- **Custom PAM Configuration:** Looks for `/etc/pam.d/dankshell` to tailor authentication flows.

## Installation Paths

### Arch Linux

Install the packaged greeter from the AUR:

```bash
paru -S greetd-dms-greeter-git
# or
yay -S greetd-dms-greeter-git
```

Then disable other display managers and enable greetd:

```bash
sudo systemctl disable gdm sddm lightdm
sudo systemctl enable greetd
```

### Fedora / RHEL / Rocky / Alma

Use the COPR repository or build the RPM locally:

```bash
sudo dnf copr enable avenge/dms
sudo dnf install dms-greeter
```

The RPM handles user creation, SELinux contexts, greetd configuration, and ships the `dms-greeter-sync` helper.

### Automatic Installer

On any distribution with the `dms` CLI available, run:

```bash
dms greeter install
```

Follow the prompts to select a compositor and configure greetd automatically.

### Manual Setup

1. Install `greetd` and `quickshell`.
2. Create the `greeter` system user and cache directory:
   ```bash
   sudo groupadd -r greeter
   sudo useradd -r -g greeter -d /var/lib/greeter -s /bin/bash -c "System Greeter" greeter
   sudo mkdir -p /var/lib/greeter /var/cache/dms-greeter
   sudo chown greeter:greeter /var/lib/greeter /var/cache/dms-greeter
   sudo chmod 750 /var/cache/dms-greeter
   ```
3. Clone the DMS repository to `/etc/xdg/quickshell/dms-greeter`:
   ```bash
   sudo git clone https://github.com/AvengeMedia/DankMaterialShell.git /etc/xdg/quickshell/dms-greeter
   ```
4. Install the launcher script:
   ```bash
   sudo cp /etc/xdg/quickshell/dms-greeter/Modules/Greetd/assets/dms-greeter /usr/local/bin/dms-greeter
   sudo chmod +x /usr/local/bin/dms-greeter
   ```
5. Configure greetd (`/etc/greetd/config.toml`):
   ```toml
   [terminal]
   vt = 1

   [default_session]
   user = "greeter"
   command = "/usr/local/bin/dms-greeter --command niri"
   ```
6. Restart greetd: `sudo systemctl enable --now greetd`.

### NixOS

Import the greeter module via flakes:

```nix
imports = [
  inputs.dankMaterialShell.nixosModules.greeter
];

programs.dankMaterialShell.greeter = {
  enable = true;
  compositor.name = "niri"; # or "hyprland"
  configHome = "/home/user"; # optional: sync theme from this user
};
```

## Theme Synchronization

Keep the greeter in sync with your main session using one of the following methods:

### Fedora RPM Helper

Run the included helper after installing the RPM:

```bash
dms-greeter-sync
```

The script handles group membership, ACLs, and symlinks automatically.

### Manual ACL Setup

1. Add your user to the `greeter` group:
   ```bash
   sudo usermod -aG greeter $USER
   ```
2. Grant traversal access to necessary directories:
   ```bash
   setfacl -m u:greeter:x ~ ~/.config ~/.local ~/.cache ~/.local/state
   ```
3. Share DMS configuration and state with the greeter:
   ```bash
   sudo chgrp -R greeter ~/.config/DankMaterialShell ~/.local/state/DankMaterialShell ~/.cache/quickshell
   sudo chmod -R g+rX ~/.config/DankMaterialShell ~/.local/state/DankMaterialShell ~/.cache/quickshell
   sudo ln -sf ~/.config/DankMaterialShell/settings.json /var/cache/dms-greeter/settings.json
   sudo ln -sf ~/.local/state/DankMaterialShell/session.json /var/cache/dms-greeter/session.json
   sudo ln -sf ~/.cache/quickshell/dankshell/dms-colors.json /var/cache/dms-greeter/colors.json
   ```
4. Log out and back in to refresh group membership.

### Custom Cache Location

Override the cache directory by setting `DMS_GREET_CFG_DIR` or passing `--cache-dir` to `dms-greeter` when configuring greetd. Ensure the directory is owned by `greeter:greeter` with `770` permissions.

## Usage

- Launch manually for testing: `dms-greeter --command niri`
- Available command options: `niri`, `hyprland`, `sway`, plus custom compositor configs via `-C /path/to/config`.
- Set `DMS_RUN_GREETER=1` when running directly with Quickshell for debugging.

## Troubleshooting Tips

- Verify `greetd` is enabled and no other display manager is running.
- Check `/var/log/greetd.log` for compositor startup errors.
- Ensure the greeter user can read shared theme files when synchronization is enabled.

With the greeter properly configured, users enjoy a consistent, polished login flow that matches the DankMaterialShell desktop.
